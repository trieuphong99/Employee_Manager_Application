{"ast":null,"code":"var _jsxFileName = \"/home/phong/rails/imp/app/javascript/staff/components/report/index.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport React, { useState, useEffect } from 'react';\nimport CKEditor from '@ckeditor/ckeditor5-react';\nimport { Input, Button, Modal, ModalHeader, ModalBody, ModalFooter, Label } from 'reactstrap';\nimport '../../../commons/components/report/build/ckeditor';\nimport { getReport, postReport, updateReport } from '../../actions/report';\nimport _ from 'lodash';\nimport { useDispatch } from 'react-redux';\nvar styles = {\n  label: {\n    fontWeight: \"600\",\n    paddingTop: \"0.5rem\"\n  }\n};\n\nvar filterData = function filterData(data, field) {\n  return _.map(data, function (o) {\n    return {\n      id: o[\"\".concat(field)]\n    };\n  });\n};\n\nvar filterMention = function filterMention(report_message, users, convertIdToName) {\n  _.map(users, function (user) {\n    return report_message = _.replace(report_message, new RegExp(convertIdToName ? user.user_id : user.user_name, \"g\"), convertIdToName ? user.user_name : user.user_id);\n  });\n\n  return report_message;\n};\n\nexport default function (props) {\n  var _useState = useState({}),\n      _useState2 = _slicedToArray(_useState, 2),\n      data = _useState2[0],\n      setData = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      send_to = _useState4[0],\n      setSendTo = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      modal = _useState6[0],\n      setModal = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      isNewReport = _useState8[0],\n      setIsNewReport = _useState8[1];\n\n  var report_id = props.report_id;\n  var dispatch = useDispatch();\n  useEffect(function () {\n    getReport(report_id, setData, setSendTo, setIsNewReport);\n  }, []);\n\n  var toggle = function toggle() {\n    return setModal(!modal);\n  };\n\n  var mentionConfig = {\n    toolbar: {\n      items: []\n    },\n    mention: {\n      feeds: [{\n        marker: '#',\n        feed: filterData(data.channels, \"channel_name\"),\n        minimumCharacters: 0\n      }]\n    }\n  };\n  var editorConfig = {\n    mention: {\n      feeds: [{\n        marker: '@',\n        feed: filterData(data.users, \"user_name\"),\n        minimumCharacters: 0\n      }]\n    }\n  }; // convert HTML to text\n\n  var stripHtml = function stripHtml(html) {\n    var tmp = document.createElement(\"DIV\");\n    tmp.innerHTML = html;\n    return tmp.textContent || tmp.innerText || \"\";\n  };\n\n  var handleSubmit = function handleSubmit() {\n    // remove unnecessary space\n    var normal = stripHtml(send_to).replace(/\\s\\s+/g, ' ').trim().split(' ');\n\n    var send_to_channels = _.map(normal, function (o) {\n      return _.find(data.channels, function (channel) {\n        return o === channel.channel_name;\n      });\n    }); //filter send_to user to submit\n\n\n    var report_message = filterMention(data.report_message, data.users, false); // report_message,\n    // send_to: send_to_channels,\n    // attachments: data.attachments\n\n    isNewReport && report_message !== \"\" ? dispatch(postReport(report_id, report_message, send_to_channels, data.attachments)) : dispatch(updateReport(report_id, report_message, send_to_channels, data.attachments));\n    toggle();\n  };\n\n  return !_.isEqual({}, data) && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 29\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"success\",\n    onClick: toggle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }\n  }, \"Report\"), /*#__PURE__*/React.createElement(Modal, {\n    size: \"lg\",\n    isOpen: modal,\n    toggle: toggle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(ModalHeader, {\n    toggle: toggle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }\n  }, \"Write your complaints daily!\"), /*#__PURE__*/React.createElement(ModalBody, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Label, {\n    style: styles.label,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }\n  }, \"Send to:\"), /*#__PURE__*/React.createElement(CKEditor, {\n    editor: ClassicEditor,\n    config: mentionConfig,\n    onChange: function onChange(event, editor) {\n      setSendTo(editor.getData());\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(Label, {\n    style: styles.label,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }\n  }, \"Report\"), /*#__PURE__*/React.createElement(CKEditor, {\n    editor: ClassicEditor,\n    config: editorConfig,\n    data: filterMention(data.report_message, data.users, true),\n    onChange: function onChange(event, editor) {\n      setData(_objectSpread(_objectSpread({}, data), {}, {\n        report_message: editor.getData()\n      }));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      marginTop: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Input, {\n    type: \"file\",\n    multiple: true,\n    onChange: function onChange(e) {\n      setData(_objectSpread(_objectSpread({}, data), {}, {\n        attachments: e.target.files\n      }));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 15\n    }\n  })))), /*#__PURE__*/React.createElement(ModalFooter, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    color: \"primary\",\n    onClick: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 11\n    }\n  }, \"Submit\"), ' ', /*#__PURE__*/React.createElement(Button, {\n    color: \"secondary\",\n    onClick: toggle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 11\n    }\n  }, \"Cancel\"))));\n}","map":{"version":3,"sources":["/home/phong/rails/imp/app/javascript/staff/components/report/index.js"],"names":["React","useState","useEffect","CKEditor","Input","Button","Modal","ModalHeader","ModalBody","ModalFooter","Label","getReport","postReport","updateReport","_","useDispatch","styles","label","fontWeight","paddingTop","filterData","data","field","map","o","id","filterMention","report_message","users","convertIdToName","user","replace","RegExp","user_id","user_name","props","setData","send_to","setSendTo","modal","setModal","isNewReport","setIsNewReport","report_id","dispatch","toggle","mentionConfig","toolbar","items","mention","feeds","marker","feed","channels","minimumCharacters","editorConfig","stripHtml","html","tmp","document","createElement","innerHTML","textContent","innerText","handleSubmit","normal","trim","split","send_to_channels","find","channel","channel_name","attachments","isEqual","ClassicEditor","event","editor","getData","marginTop","e","target","files"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport CKEditor from '@ckeditor/ckeditor5-react';\nimport { Input, Button, Modal, ModalHeader, ModalBody, ModalFooter, Label } from 'reactstrap';\nimport '../../../commons/components/report/build/ckeditor'\nimport { getReport, postReport, updateReport } from '../../actions/report'\nimport _ from 'lodash';\nimport { useDispatch } from 'react-redux';\n\nconst styles = {\n  label: {\n    fontWeight: \"600\",\n    paddingTop: \"0.5rem\"\n  }\n}\n\nconst filterData = (data, field) => _.map(data, o => ({ id: o[`${field}`] }))\n\nconst filterMention = (report_message, users, convertIdToName) => {\n  _.map(users,\n    user =>\n      report_message = _.replace(report_message, new RegExp(convertIdToName ? user.user_id : user.user_name, \"g\"), convertIdToName ? user.user_name : user.user_id)\n  )\n  return report_message\n}\n\nexport default function (props) {\n  const [data, setData] = useState({})\n  const [send_to, setSendTo] = useState(\"\");\n  const [modal, setModal] = useState(false);\n  const [isNewReport, setIsNewReport] = useState(true)\n  const { report_id } = props;\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    getReport(report_id, setData, setSendTo, setIsNewReport)\n  }, [])\n\n  const toggle = () => setModal(!modal)\n\n  const mentionConfig = {\n    toolbar: {\n      items: []\n    },\n    mention: {\n      feeds: [\n        {\n          marker: '#',\n          feed: filterData(data.channels, \"channel_name\"),\n          minimumCharacters: 0\n        }\n      ]\n    }\n  }\n\n  const editorConfig = {\n    mention: {\n      feeds: [\n        {\n          marker: '@',\n          feed: filterData(data.users, \"user_name\"),\n          minimumCharacters: 0\n        },\n      ]\n    }\n  };\n\n  // convert HTML to text\n  const stripHtml = html => {\n    var tmp = document.createElement(\"DIV\");\n    tmp.innerHTML = html;\n    return tmp.textContent || tmp.innerText || \"\";\n  }\n\n  const handleSubmit = () => {\n    // remove unnecessary space\n    const normal = stripHtml(send_to).replace(/\\s\\s+/g, ' ').trim().split(' ')\n\n    const send_to_channels = _.map(normal,\n      o => _.find(data.channels, channel => o === channel.channel_name)\n    )\n\n    //filter send_to user to submit\n    const report_message = filterMention(data.report_message, data.users, false)\n\n    // report_message,\n    // send_to: send_to_channels,\n    // attachments: data.attachments\n    isNewReport && report_message !== \"\"\n      ? dispatch(postReport(report_id, report_message, send_to_channels, data.attachments))\n      : dispatch(updateReport(report_id, report_message, send_to_channels, data.attachments))\n    toggle()\n  }\n\n  return (\n    !_.isEqual({}, data) && <div>\n      <Button color=\"success\" onClick={toggle}>Report</Button>\n      <Modal size=\"lg\" isOpen={modal} toggle={toggle}>\n        <ModalHeader toggle={toggle}>Write your complaints daily!</ModalHeader>\n        <ModalBody>\n          <div>\n            <Label style={styles.label}>Send to:</Label>\n            <CKEditor\n              editor={ClassicEditor}\n              config={mentionConfig}\n              onChange={(event, editor) => {\n                setSendTo(editor.getData())\n              }}\n            />\n            <Label style={styles.label}>Report</Label>\n            <CKEditor\n              editor={ClassicEditor}\n              config={editorConfig}\n              data={filterMention(data.report_message, data.users, true)}\n              onChange={(event, editor) => {\n                setData({ ...data, report_message: editor.getData() })\n              }}\n            />\n            <div style={{ marginTop: \"10px\" }}>\n              <Input\n                type=\"file\"\n                multiple\n                onChange={e => {\n                  setData({ ...data, attachments: e.target.files })\n                }}\n              />\n            </div>\n          </div>\n        </ModalBody>\n        <ModalFooter>\n          <Button color=\"primary\" onClick={handleSubmit}>Submit</Button>{' '}\n          <Button color=\"secondary\" onClick={toggle}>Cancel</Button>\n        </ModalFooter>\n      </Modal>\n    </div >\n  );\n}"]},"metadata":{},"sourceType":"module"}